
# Do not modify this file directly, it is built by ./tasks/node/build-circleci-config.js.
version: 2.1
jobs:
  lint_js:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run lint
  unit_tests:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run build && npm run test-node && npm run test-node-unit
  publish_to_npm:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: echo "//registry.npmjs.org/:_authToken=$NPM_TOKEN" > ~/.npmrc
      - run: npm publish
  test_Blob:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=Blob --browserstack
  test_CustomEvent:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=CustomEvent --browserstack
  test_DocumentFragment:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=DocumentFragment --browserstack
  test_Event:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=Event --browserstack
  test_IntersectionObserverEntry:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=IntersectionObserverEntry
          --browserstack
  test_Map:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=Map --browserstack
  test_Promise:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=Promise --browserstack
  test_Set:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=Set --browserstack
  test_Symbol:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=Symbol --browserstack
  test_URL:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=URL --browserstack
  test_UserTiming:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=UserTiming --browserstack
  test_WeakMap:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=WeakMap --browserstack
  test_WeakSet:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=WeakSet --browserstack
  test_XMLHttpRequest:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=XMLHttpRequest --browserstack
  test_atob:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=atob --browserstack
  test_console:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=console --browserstack
  test_matchMedia:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=matchMedia --browserstack
  test_requestAnimationFrame:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=requestAnimationFrame
          --browserstack
  test_setImmediate:
    docker:
      - image: circleci/node:10
    steps:
      - checkout
      - run: yarn install --frozen-lockfile
      - run: npm run test-polyfills -- --feature=setImmediate --browserstack
workflows:
  test:
    jobs:
      - lint_js:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
      - unit_tests:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
      - publish_to_npm:
          filters:
            tags:
              only: /^v.*/
            branches:
              ignore: /.*/
      - test_Blob:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
      - test_CustomEvent:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
      - test_DocumentFragment:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
      - test_Event:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
      - test_IntersectionObserverEntry:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
      - test_Map:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
      - test_Promise:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
      - test_Set:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
      - test_Symbol:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
      - test_URL:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
      - test_UserTiming:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
      - test_WeakMap:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
      - test_WeakSet:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
            - test_WeakMap
      - test_XMLHttpRequest:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
            - test_WeakMap
            - test_WeakSet
      - test_atob:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
            - test_WeakMap
            - test_WeakSet
            - test_XMLHttpRequest
      - test_console:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
            - test_WeakMap
            - test_WeakSet
            - test_XMLHttpRequest
            - test_atob
      - test_matchMedia:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
            - test_WeakMap
            - test_WeakSet
            - test_XMLHttpRequest
            - test_atob
            - test_console
      - test_requestAnimationFrame:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
            - test_WeakMap
            - test_WeakSet
            - test_XMLHttpRequest
            - test_atob
            - test_console
            - test_matchMedia
      - test_setImmediate:
          filters:
            tags:
              ignore: /^v.*/
            branches:
              ignore: master
          requires:
            - lint_js
            - unit_tests
            - test_Blob
            - test_CustomEvent
            - test_DocumentFragment
            - test_Event
            - test_IntersectionObserverEntry
            - test_Map
            - test_Promise
            - test_Set
            - test_Symbol
            - test_URL
            - test_UserTiming
            - test_WeakMap
            - test_WeakSet
            - test_XMLHttpRequest
            - test_atob
            - test_console
            - test_matchMedia
            - test_requestAnimationFrame
